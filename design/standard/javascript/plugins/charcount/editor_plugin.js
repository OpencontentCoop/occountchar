tinymce.create("tinymce.plugins.CharCount",{block:0,id:null,countre:null,cleanre:null,init:function(t,n){function e(t){return t!==c&&(t===r.ENTER||t===r.SPACEBAR||t===r.DELETE)}function o(t){return t===r.DELETE||t===r.BACKSPACE}var a=this,c=0,r=tinymce.VK;a.countre=t.getParam("charcount_countregex",/[\w\u2019\'-]+/g),a.cleanre=t.getParam("charcount_cleanregex",/[.(),;:!?%#$?\'\"_+=\\\/-]*/g),a.update_rate=t.getParam("charcount_update_rate",1e3),a.update_on_delete=t.getParam("charcount_update_on_delete",!0),a.id=t.id+"-char-count",t.onPostRender.add(function(t,n){var e,o;(o=t.getParam("charcount_target_id"))?tinymce.DOM.add(o,"span",{},'<span id="'+a.id+'">0</span>'):(e=tinymce.DOM.get(t.id+"_path_row"))&&tinymce.DOM.add(e.parentNode,"div",{style:"float: right"},t.getLang("charcount.chars","Chars: ")+'<span id="'+a.id+'">0</span>')}),t.onInit.add(function(t){t.selection.onSetContent.add(function(){a._count(t)}),a._count(t)}),t.onSetContent.add(function(t){a._count(t)}),t.onKeyUp.add(function(t,n){(e(n.keyCode)||a.update_on_delete&&o(n.keyCode))&&a._count(t),c=n.keyCode})},_getCount:function(t){var n=t.getContent({format:"raw"});return this._decodeHtml(n).replace(/(<([^>]+)>)/gi,"").length},_decodeHtml:function(t){var n=document.createElement("textarea");return n.innerHTML=t,n.value},_count:function(t){var n=this;n.block||(n.block=1,setTimeout(function(){if(!t.destroyed){var e=n._getCount(t);tinymce.DOM.setHTML(n.id,e.toString()),setTimeout(function(){n.block=0},n.update_rate)}},1))},getInfo:function(){return{longname:"Char Count plugin",author:"OpenContent Scarl",authorurl:"http://www.opencontent.it",infourl:"http://www.opencontent.it/TinyMCE:Plugins/charcount",version:tinymce.majorVersion+"."+tinymce.minorVersion}}}),tinymce.PluginManager.add("charcount",tinymce.plugins.CharCount);